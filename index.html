<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <meta name="theme-color" content="#f3f4f6" />
  <title>ÎùºÏù¥Î∏åÎçîÏÑºÌÖÄ Ï£ºÏ∞®ÏúÑÎ∞ò Ï†úÎ≥¥</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;600;700;800;900&display=swap" rel="stylesheet" />

  <!-- React -->
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

  <style>
    :root {
      --bg:#f3f4f6;
      --card:#fff;
      --text:#0f172a;
      --muted:#64748b;
      --primary:#111827;
      --danger:#ef4444;
      --radius:22px;
      --shadow:0 8px 20px rgba(15,23,42,.08);
    }

    *{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
    body{
      margin:0;background:var(--bg);
      font-family:"Noto Sans KR",-apple-system,BlinkMacSystemFont,system-ui,sans-serif;
      color:var(--text)
    }

    .screen{padding:16px 16px calc(110px + env(safe-area-inset-bottom))}
    h1{font-size:26px;margin:8px 0 14px;font-weight:900}

    .banner{
      height:120px;border-radius:22px;padding:16px;
      background:linear-gradient(135deg,#eef2ff,#fff1f2);
      box-shadow:var(--shadow);
      display:flex;align-items:flex-end;justify-content:space-between
    }

    .chip{
      background:#fff;border-radius:999px;
      padding:10px 14px;font-weight:800;font-size:14px
    }

    .section{margin:22px 0 12px;font-size:16px;font-weight:900}

    .card{
      background:var(--card);border-radius:22px;
      padding:18px;margin-bottom:14px;box-shadow:var(--shadow)
    }

    label{font-weight:800;font-size:16px}
    .hint{font-size:13px;color:var(--muted);margin-top:6px}

    input,textarea{
      width:100%;margin-top:12px;
      padding:14px;border-radius:16px;
      border:1px solid #e5e7eb;
      font-size:16px
    }

    textarea{min-height:110px}

    .btn-row{display:flex;gap:10px;margin-top:14px}
    .btn{
      flex:1;padding:14px;border-radius:999px;
      border:1px solid #d1d5db;
      background:#fff;font-weight:800;font-size:15px
    }

    .previews{display:flex;gap:12px;margin-top:14px;overflow-x:auto}
    .thumb{width:110px;height:110px;border-radius:18px;overflow:hidden;position:relative}
    .thumb img{width:100%;height:100%;object-fit:cover}
    .thumb button{
      position:absolute;top:6px;right:6px;
      width:32px;height:32px;border-radius:50%;
      border:none;background:rgba(0,0,0,.7);color:#fff;font-size:20px
    }

    .bottom{
      position:fixed;left:0;right:0;bottom:0;
      padding:10px 14px calc(10px + env(safe-area-inset-bottom));
      background:rgba(243,244,246,.96);border-top:1px solid #e5e7eb
    }

    .submit{
      width:100%;padding:18px;border-radius:18px;
      background:var(--primary);color:#fff;
      font-size:18px;font-weight:900;border:none
    }

    .submit:disabled{opacity:.4}
    .toast{margin-top:12px;font-size:14px}
  </style>
</head>

<body>
<div id="root"></div>

<script>
/* ======================
   ‚ö†Ô∏è Ïó¨Í∏∞Îßå ÏàòÏ†ï
====================== */
const API_URL = "https://dawn-frost-9b1a.wlasqqq.workers.dev/api/report";

const {useState,useRef,useEffect,useMemo} = React;

function App(){
  const fileRef = useRef();
  const [pickMode,setPickMode] = useState("camera");

  const [location,setLocation] = useState("");
  const [plate,setPlate] = useState("");
  const [note,setNote] = useState("");
  const [files,setFiles] = useState([]);
  const [agree,setAgree] = useState(false);
  const [loading,setLoading] = useState(false);
  const [toast,setToast] = useState("");

  const canSubmit = useMemo(
    ()=>location && plate && files.length && agree && !loading,
    [location,plate,files,agree,loading]
  );

  function pick(mode){
    setPickMode(mode);
    fileRef.current.click();
  }

  function onFiles(e){
    setFiles(prev=>[...prev,...Array.from(e.target.files)]);
    e.target.value="";
  }

  function remove(idx){
    setFiles(f=>f.filter((_,i)=>i!==idx));
  }

  function toBase64(f){
    return new Promise(r=>{
      const fr=new FileReader();
      fr.onload=()=>r(fr.result);
      fr.readAsDataURL(f);
    });
  }

  async function submit(){
    setLoading(true);setToast("");
    try{
      const images=[];
      for(const f of files) images.push(await toBase64(f));

      await fetch(API_URL,{
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify({
          location,plate,note,images,
          ip:"-"
        })
      });

      setToast("Ï†ëÏàò ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§.");
      setLocation("");setPlate("");setNote("");setFiles([]);setAgree(false);
    }catch(e){
      setToast("Ï†úÏ∂ú Ïã§Ìå®");
    }finally{
      setLoading(false);
    }
  }

  return (
    React.createElement("div",{className:"screen"},
      React.createElement("h1",null,"üö´ ÎùºÏù¥Î∏åÎçîÏÑºÌÖÄ Ï£ºÏ∞®ÏúÑÎ∞ò Ï†úÎ≥¥"),

      React.createElement("div",{className:"banner"},
        React.createElement("div",{className:"chip"},"Live the Centum"),
        React.createElement("div",{className:"chip"},"Ï¶ùÍ±∞Ï†úÎ≥¥")
      ),

      React.createElement("div",{className:"section"},"Ïã†Í≥† ÎÇ¥Ïö©"),

      React.createElement("div",{className:"card"},
        React.createElement("label",null,"üìç ÏúÑÏπò"),
        React.createElement("div",{className:"hint"},"Îèô¬∑Ï∏µ¬∑Íµ¨Ïó≠ÏùÑ Íµ¨Ï≤¥Ï†ÅÏúºÎ°ú"),
        React.createElement("input",{value:location,onChange:e=>setLocation(e.target.value)})
      ),

      React.createElement("div",{className:"card"},
        React.createElement("label",null,"üöó Ï∞®ÎüâÎ≤àÌò∏"),
        React.createElement("input",{value:plate,onChange:e=>setPlate(e.target.value)})
      ),

      React.createElement("div",{className:"card"},
        React.createElement("label",null,"üì∏ ÏÇ¨ÏßÑ"),
        React.createElement("div",{className:"btn-row"},
          React.createElement("button",{className:"btn",onClick:()=>pick("camera")},"Ï¥¨ÏòÅ"),
          React.createElement("button",{className:"btn",onClick:()=>pick("gallery")},"Í∞§Îü¨Î¶¨")
        ),
        React.createElement("input",{
          ref:fileRef,type:"file",accept:"image/*",multiple:true,
          capture: pickMode==="camera"?"environment":undefined,
          onChange:onFiles,style:{display:"none"}
        }),
        React.createElement("div",{className:"previews"},
          files.map((f,i)=>
            React.createElement("div",{className:"thumb",key:i},
              React.createElement("img",{src:URL.createObjectURL(f)}),
              React.createElement("button",{onClick:()=>remove(i)},"√ó")
            )
          )
        )
      ),

      React.createElement("div",{className:"card"},
        React.createElement("label",null,"üìù ÎπÑÍ≥†"),
        React.createElement("textarea",{value:note,onChange:e=>setNote(e.target.value)})
      ),

      React.createElement("div",{className:"card"},
        React.createElement("label",null,
          React.createElement("input",{type:"checkbox",checked:agree,onChange:e=>setAgree(e.target.checked)}),
          " Ï¶ùÍ±∞ Ï†úÍ≥µ ÎèôÏùò"
        )
      ),

      React.createElement("div",{className:"bottom"},
        React.createElement("button",{className:"submit",disabled:!canSubmit,onClick:submit},
          loading?"Ï†úÏ∂ú Ï§ë...":"Ïã†Í≥† Ï†úÏ∂ú"
        ),
        toast && React.createElement("div",{className:"toast"},toast)
      )
    )
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(React.createElement(App));
</script>
</body>
</html>
